<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport"
        content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <link rel="stylesheet" href="js/datepicker/foundation-datepicker.css">
    <link rel="stylesheet" href="css/information_t.css">
    <link rel="stylesheet" type="text/css" href="css/mobileSelect.css">
    <title>身份信息认证上报</title>
</head>
<body>
    <div class="title">
        <div class="timg">
           <div class="goback" onclick="history.go(-1)"><img src="images/tao/nav_back.png" alt=""></div>
            <p class="h-title">身份信息认证上报</p>
        </div>
        <div class="live">
            <p class="live-time">居住时效</p>
            <div class="means-input">
                <input type="text" placeholder="选择居住开始时间" class="measn" id="select_1" onfocus="this.blur()">
                <img src="images/tao/down.png">
            </div>
            <p class="live-long">- 长期</p>
        </div>
        <div class="facell">
            <div class="face" id="enter1">
                <img src="images/tao/face.png" alt="" id="preview10">
                <p class="faceword" id="faceph">点击拍摄人脸照片</p>
            </div>
            <div class="allimg">
                <div class="a">
                    <div class="facefront fan" id="enter2">
                        <img src="images/tao/bag.png" class="face-front" id="preview11">
                        <div class="word">证件正面</div>
                        <p class="faceword1" id="prev1">点击上传/拍摄证件正面</p>
                    </div>
                </div>
                <!-- <div id="content" style="width: 90%;min-height: 300px;margin-top:20px;overflow: auto;"></div> -->
                <div class="a" style="margin-top:20px;" id="enter3">
                    <div class="facefront fan">
                        <img src="images/tao/bag.png" class="face-front" id="preview12">
                        <div class="word">证件背面</div>
                        <p class="faceword1" id="prev2">点击上传/拍摄证件背面</p>
                    </div>
                </div>
            </div>
        </div>
        <div class="border"></div>
        <div class="means">
            <div class="meanslist">
                <div class="means-name">证件类型</div>
                <div class="means-input">
                    <input type="text" placeholder="选择证件类型" class="measn" id="trigger1" onfocus="this.blur()">
                    <img src="images/tao/down.png">
                </div>
            </div>
            <div class="meanslist">
                <div class="means-name">姓&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;名</div>
                <div class="means-input12">
                    <input type="text" placeholder="录入姓名" class="measn12" id="namev">
                </div>
            </div>
            <div class="meanslist">
                <div class="means-name">性&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;别</div>
                <div class="means-input">
                    <input type="text" placeholder="选择性别" class="measn" id="trigger2" onfocus="this.blur()">
                    <img src="images/tao/down.png">
                </div>
            </div>
            <div class="meanslist">
                <div class="means-name">生&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;日</div>

                <div class="means-input">
                    <input type="text" placeholder="选择生日" class="measn" id="select_2" onfocus="this.blur()">
                    <img src="images/tao/down.png">
                </div>

            </div>
            <div class="meanslist">
                <div class="means-name">民&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;族</div>

                <div class="means-input">
                    <input type="text" placeholder="选择民族" class="measn" id="trigger3" value="" onfocus="this.blur()">
                    <img src="images/tao/down.png">
                </div>
            </div>
            <div class="meanslist">
                <div class="means-name">证件号码</div>
                <div class="means-input12">
                    <input type="text" placeholder="录入证件号码" class="measn12" id="measnnum">
                </div>
            </div>
            <div class="meanslist">
                <div class="means-name">证件时效</div>

                <div class="means-input">
                    <input type="text" placeholder="选择证件有效期" class="measn" id="select_3" onfocus="this.blur()">
                    <img src="images/tao/down.png">

                </div>
            </div>
            <div class="meanslist">
                <div class="means-name">办证机关</div>
                <div class="means-input12">
                    <input type="text" placeholder="录入办证机关" class="measn12" id="measn12">
                </div>
            </div>
            <div class="meanslist">
                <div class="means-name">证件地址</div>
                <div class="means-input13">
                    <textarea rows="5" cols="" placeholder="录入证件地址" class="text" id="address"></textarea>
                </div>
            </div>
            <div class="meanslist">
                <div class="means-name">联系方式</div>
                <div class="means-input12">
                    <input type="text" placeholder="录入手机号码" class="measn12">
                </div>
            </div>
        </div>
       <div class="btn">提交</div>
    </div>
    <script type="text/javascript" src="js/jquery-3.3.1.min.js"></script>
    <script type="text/javascript" src="js/selectDate.js"></script>
    <script type="text/javascript" src="js/mobileSelect.js"></script>
    <script type="text/javascript" src="js/alrem.js" charset="utf-8"></script>
    <script type="text/javascript" src="js/jquery.base64.js" charset="utf-8"></script>
    <script type="text/javascript" src="js/demo.js" charset="utf-8"></script>
    <script>
    $(function(){
        var select1 = $.selectDate("#select_1", {
            start: 1994,
            end:2999,
            select: [2012, 2, 15],
            title: '请选择居住开始时间'
        }, function (data) {
            console.log(data);
            document.getElementById('select_1').value = data.year + "-" + data.month + "-" + data.day
            // $("#select_2").value(data.year+"年"+data.month+"月"+data.day+"日");
        });
        var weekdayArr2;
        var weekdayArr;
        $.ajax({
            //请求方式
            type:'POST',
            //发送请求的地址
            url:'/jianfuzengxiao/api/common/getNationList.html',
            //服务器返回的数据类型
            dataType:'json',
            //发送到服务器的数据，对象必须为key/value的格式，jquery会自动转换为字符串格式
            data:{},
            success:function(data){
                //console.log(data.data)
               
                    //[{nationId: "1", nationName: "汉族"},{nationId: "1", nationName: "汉族"}]
                weekdayArr2 = data.data//[{key:"1",value:'汉族'}, {key:"2",value:'满族'},{key:"3",value:'藏族'} , {key:"4",value:'维吾尔'}, {key:"5",value:'维11吾尔'}];
                for(var i in weekdayArr2){
                    for(var j in weekdayArr2[i]){
                        if(j == 'nationName'){
                            weekdayArr2[i]['value'] = weekdayArr2[i][j]//修改属性名为“value”
                            delete weekdayArr2[i]['nationName']//删除“nationName”
                        }
                        if(j == 'nationId'){
                            weekdayArr2[i]['id'] = weekdayArr2[i][j]//修改属性id为“id”
                            delete weekdayArr2[i]['nationId']//删除“nationId”
                        }
                    }
                }
                console.log(weekdayArr2)
                $.ajax({
                    //请求方式
                    type:'POST',
                    //发送请求的地址
                    url:'/jianfuzengxiao/api/common/getCertTypeList.html',
                    //服务器返回的数据类型
                    dataType:'json',
                    //发送到服务器的数据，对象必须为key/value的格式，jquery会自动转换为字符串格式
                    data:{},
                    success:function(data){
                        weekdayArr = data.data
                        // console.log(weekdayArr)
                        for(var i in weekdayArr){
                            for(var j in weekdayArr[i]){
                                if(j == 'certificatesTypeName'){
                                    weekdayArr[i]['value'] = weekdayArr[i][j]//修改属性名为“value”
                                    delete weekdayArr[i]['certificatesTypeName']//删 除“nationName”
                                }
                            }
                        }
                        console.log(weekdayArr)

                        if(weekdayArr !== '' && weekdayArr2 !== ''){
                            sessionStorage.setItem('weekdayArr',JSON.stringify(weekdayArr))
                            sessionStorage.setItem('weekdayArr2',JSON.stringify(weekdayArr2))
                            Positive('身份证','女','1992-01-08','回族');
                            Back('2012-2-8');
                            // Positive('身份证','男','1998-01-09','汉族');
                            // Back('2012-2-10');
                        }
                    },
                    error:function(jqXHR){
                    }
                }); 
            },
            error:function(jqXHR){
            }
        }); 

    })
    function contains(arrays, obj) {
        // var i = arrays.length;
        for(var i = 0;i<arrays.length;i++){
            if(arrays[i].value == obj){
                return i;
            }
        }
        return false;
    }
    function Positive(type,Gender,birthday,Nation){
        var arr = $('.mobileSelect')
        console.log(arr.length)
        for(var i = 0; i< arr.length;i++){
            if(arr.eq(i).find('.title').html() === "有效证件" || arr.eq(i).find('.title').html() == "性别" || arr.eq(i).find('.title').html() == "生日" || arr.eq(i).find('.title').html() == "民族" ){
                arr.eq(i).remove();
            }
        }
        //获取民族
        var weekdayArr2 = JSON.parse(sessionStorage.getItem('weekdayArr2'))
        var i = contains(weekdayArr2,Nation);
        var mobileSelect0 = new MobileSelect({
            trigger: '#trigger3',
            title: '民族',
            wheels: [
                { data: weekdayArr2 }
            ],
            position: [i], //初始化定位 打开时默认选中的哪个 如果不填默认为0
            transitionEnd: function (indexArr, data) {
                console.log(data);
            },
            callback: function (indexArr, data) {
                console.log(data);
                document.getElementById('trigger3').value = data[0].value
                //$('#trigger3').val(data.value);
            }
        });
        //获取证件
        var weekdayArr = JSON.parse(sessionStorage.getItem('weekdayArr'))
        var i = contains(weekdayArr,type);
        var mobileSelect1 = new MobileSelect({
            trigger: '#trigger1',
            title: '有效证件',
            wheels: [
                { data: weekdayArr }
            ],
           position: [i], //初始化定位 打开时默认选中的哪个 如果不填默认为0
            transitionEnd: function (indexArr, data) {
                console.log(data);
            },
            callback: function (indexArr, data) {
                console.log(data);
                document.getElementById('trigger1').value = data[0].value;
            }
        });
        // var weekdayArr = ['身份证', '驾驶证'];
        var weekdayArr1 = [{id:0,value:'男'},{id:1,value:'女'}];
       //var weekdayArr2 = [{id:"1",value:'汉族'}, {id:"2",value:'满族'},{id:"3",value:'藏族'} , {id:"4",value:'维吾尔'}, {id:"5",value:'维11吾尔'}];
        var date=new Date;
        var i = contains(weekdayArr1,Gender);
        // console.log(i);
        var mobileSelect2 = new MobileSelect({
            trigger: '#trigger2',
            title: '性别',
            wheels: [
                { data: weekdayArr1 }
            ],
            position: [i], //初始化定位 打开时默认选中的哪个 如果不填默认为0
            transitionEnd: function (indexArr, data) {
                console.log(data);
            },
            callback: function (indexArr, data) {
                console.log(data);
                document.getElementById('trigger2').value = data[0].value;
            }
        });
        var birthday0 = birthday.split('-')
        $.selectDate("#select_2", {
            select: birthday0,
            title: '生日'
        }, function (data) {
            console.log(data);
            document.getElementById('select_2').value = data.year + "-" + data.month + "-" + data.day
        });
    }

    function Back(Prescription){
        var arr = $('.mobileSelect')
        for(var i = 0; i< arr.length;i++){
            if(arr.eq(i).find('.title').html() == "证件有效日期"){
                arr.eq(i).remove();
            }
        }
        var Prescription0 = Prescription.split('-')
        var select3 = $.selectDate("#select_3", { 
            start: 1994,
            end: 2999,
            select: Prescription0,
            title: '证件有效日期'
        }, function (data) {
            console.log(data);
            document.getElementById('select_3').value = data.year + "-" + data.month + "-" + data.day
            // $("#select_2").value(data.year+"年"+data.month+"月"+data.day+"日");
        });
    }
        // function goback(){
        //     window.goback(-1)
        // }
    </script>
</body>
</html>